<!DOCTYPE html>
<html lang="el">
<head>
    <script src="libs/NoSleep.min.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="title">ŒïœÅœâœÑŒÆœÉŒµŒπœÇ œÄœÅŒøœÇ ŒüŒºŒπŒªŒ∑œÑŒ≠œÇ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #a2b2c2;
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }

        .container {
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
            background: rgb(187, 214, 245);
            border-radius: 0;
            box-shadow: none;
            overflow: hidden;
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .header-logo-container {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            width: calc(min(12vw, 60px)); /* Smaller max size to prevent spill */
            height: calc(min(12vw, 60px)); /* Same height as width */
            max-width: 60px;
            max-height: 60px;
            min-width: 35px;
            min-height: 35px;
        }

        .header-content {
            flex: 1;
            text-align: center;
            margin-left: calc(min(12vw, 60px) + 20px); /* Logo width + position from left */
            margin-right: 20px; /* Right position from edge */
            padding: 0; /* Remove any default padding */
        }

        .header h1 {
            font-size: 20px;
            margin: 0; /* Remove all margins */
            padding: 0; /* Remove all padding */
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 14px;
            margin: 0;
        }

        .form-container {
            padding: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }

        input[type="text"],
        input[type="email"],
        select,
        textarea {
            width: 100%;
            padding: 10px 14px;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        input[type="text"]:focus,
        input[type="email"]:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #2c3e50;
            background: white;
            box-shadow: 0 0 0 3px rgba(44, 62, 80, 0.1);
        }

        select {
            cursor: pointer;
        }

        textarea {
            resize: vertical;
            min-height: 100px;
            font-family: inherit;
        }

        .submit-btn {
            width: 100%;
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            border: none;
            padding: 14px 18px;
            font-size: 18px;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 15px;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(44, 62, 80, 0.3);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .required {
            color: #e74c3c;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #c3e6cb;
            display: none;
        }

        .char-counter {
            text-align: right;
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }

        @media (max-width: 600px) {
            .container {
                margin: 0;
                border-radius: 0;
            }
            
            .header {
                padding: 15px;
            }
            
            .header-logo-container {
                left: 15px; /* Closer to edge on mobile */
            }
            
            .header-content {
                margin-left: calc(min(12vw, 60px) + 15px); /* Logo width + position on mobile */
                margin-right: 15px; /* Edge position on mobile */
            }
            
            /* Language selector mobile adjustments */
            .language-selector {
                right: 15px !important; /* Closer to edge on mobile */
                gap: 6px !important; /* Smaller gap on mobile */
            }
            
            .lang-flag {
                font-size: 20px !important; /* Smaller flags on mobile */
            }
            
            .form-container {
                padding: 15px;
            }
        }

        /* Autocomplete Styles Œ≥ŒπŒ± ŒìŒïŒúŒó API */
        .autocomplete-container {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .autocomplete-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid #e1e5e9;
            border-top: none;
            border-radius: 0 0 12px 12px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: none;
        }

        .autocomplete-item {
            padding: 12px 14px;
            cursor: pointer;
            border-bottom: 1px solid #f1f3f4;
            transition: background-color 0.2s ease;
        }

        .autocomplete-item:hover,
        .autocomplete-item.highlighted {
            background-color: #f8f9fa;
        }

        .autocomplete-item:last-child {
            border-bottom: none;
        }

        .company-name {
            font-weight: 600;
            color: #2c3e50;
            font-size: 14px;
        }

        .company-source {
            font-weight: 400;
            color: #7f8c8d;
            font-size: 11px;
            margin-left: 8px;
        }

        .company-details {
            color: #666;
            font-size: 12px;
            margin-top: 2px;
        }

        .loading-indicator {
            padding: 12px 14px;
            text-align: center;
            color: #666;
            font-style: italic;
        }

        .no-results {
            padding: 12px 14px;
            text-align: center;
            color: #999;
            font-style: italic;
        }
    </style>
</head>
<body>
    <!-- Right-click context menu -->
    <div id="contextMenu" style="position: fixed; background: #2c3e50; border: 1px solid #34495e; border-radius: 4px; padding: 8px 0; display: none; z-index: 9999; box-shadow: 0 2px 10px rgba(0,0,0,0.3);">
        <div id="setPcName" style="padding: 8px 16px; cursor: pointer; color: white; font-size: 14px; transition: background 0.2s;" onmouseover="this.style.background='#34495e'" onmouseout="this.style.background='transparent'">
            üíª Set PC Name
        </div>
    </div>
    
    <!-- Custom input dialog -->
    <div id="pcNameDialog" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); display: none; z-index: 10000; justify-content: center; align-items: center;">
        <div style="background: #2c3e50; padding: 20px; border-radius: 8px; color: white; text-align: center; box-shadow: 0 4px 20px rgba(0,0,0,0.5);">
            <h3 style="margin-top: 0; color: #ecf0f1;">üíª ŒåŒΩŒøŒºŒ± Œ•œÄŒøŒªŒøŒ≥ŒπœÉœÑŒÆ</h3>
            <input type="text" id="pcNameInput" style="width: 200px; padding: 8px; margin: 10px 0; border: none; border-radius: 4px; font-size: 16px; text-align: center;" placeholder="œÄ.x. ASUS">
            <div style="margin-top: 15px;">
                <button id="pcNameOk" style="background: #27ae60; color: white; border: none; padding: 8px 16px; margin: 0 5px; border-radius: 4px; cursor: pointer; font-size: 14px;">OK</button>
                <button id="pcNameCancel" style="background: #e74c3c; color: white; border: none; padding: 8px 16px; margin: 0 5px; border-radius: 4px; cursor: pointer; font-size: 14px;">ŒëŒ∫œçœÅœâœÉŒ∑</button>
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="header">
            <div class="header-logo-container">
                <div id="header-logo" style="width: 100%; height: 100%; background-size: contain; background-repeat: no-repeat; background-position: center; display: none;"></div>
            </div>
            <div class="header-content">
                <h1 id="conference-title">TimeCast‚Ñ¢ Pro</h1>
            </div>
        </div>

        <!-- Language Selector - Two Rows -->
        <div class="language-selector" style="
            text-align: center;
            padding: 15px 0;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            margin: 0 auto;
            max-width: 900px;
            border-radius: 15px;
            margin-top: 10px;
            margin-bottom: 10px;
        ">
            <!-- First Row - 12 languages -->
            <div style="
                display: flex;
                justify-content: space-evenly;
                align-items: center;
                margin-bottom: 10px;
                flex-wrap: wrap;
                padding: 0 20px;
            ">
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('el')" title="ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨">üá¨üá∑</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('en')" title="English">üá∫üá∏</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('fr')" title="Fran√ßais">üá´üá∑</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('de')" title="Deutsch">üá©üá™</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('es')" title="Espa√±ol">üá™üá∏</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('it')" title="Italiano">üáÆüáπ</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('da')" title="Dansk">üá©üá∞</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('uk')" title="–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞">üá∫üá¶</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('nl')" title="Nederlands">üá≥üá±</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('pt')" title="Portugu√™s">üáµüáπ</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('ro')" title="Rom√¢nƒÉ">üá∑üá¥</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('hr')" title="Hrvatski">üá≠üá∑</div>
            </div>
            
            <!-- Second Row - 12 languages -->
            <div style="
                display: flex;
                justify-content: space-evenly;
                align-items: center;
                flex-wrap: wrap;
                padding: 0 20px;
            ">
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('pl')" title="Polski">üáµüá±</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('lv')" title="Latvie≈°u">üá±üáª</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('sl')" title="Sloven≈°ƒçina">üá∏üáÆ</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('et')" title="Eesti">üá™üá™</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('fi')" title="Suomi">üá´üáÆ</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('sv')" title="Svenska">üá∏üá™</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('cs')" title="ƒåe≈°tina">üá®üáø</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('hu')" title="Magyar">üá≠üá∫</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('lt')" title="Lietuvi≈≥">üá±üáπ</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('sk')" title="Slovenƒçina">üá∏üá∞</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('bg')" title="–ë—ä–ª–≥–∞—Ä—Å–∫–∏">üáßüá¨</div>
                <div class="lang-flag" style="cursor: pointer; font-size: 24px; opacity: 0.7; transition: opacity 0.2s, transform 0.2s; user-select: none;" onclick="switchLanguage('mt')" title="Malti">üá≤üáπ</div>
            </div>
        </div>

        <div class="form-container">
            <p style="text-align: center; margin-bottom: 20px; color: #555; font-size: 16px; font-weight: 500;" data-i18n="subtitle">
                Œ•œÄŒøŒ≤Œ¨ŒªŒµœÑŒµ œÑŒ∑ŒΩ ŒµœÅœéœÑŒ∑œÉŒÆ œÉŒ±œÇ
            </p>
            
            <div class="success-message" id="successMessage" data-i18n="successMessage">
                ‚úÖ Œó ŒµœÅœéœÑŒ∑œÉŒÆ œÉŒ±œÇ œÖœÄŒøŒ≤ŒªŒÆŒ∏Œ∑Œ∫Œµ ŒµœÄŒπœÑœÖœáœéœÇ! ŒòŒ± ŒµŒæŒµœÑŒ±œÉœÑŒµŒØ Œ±œÄœå œÑŒ∑ Œ¥ŒπŒøœÅŒ≥Œ¨ŒΩœâœÉŒ∑.
            </div>

            <form id="questionForm">
                <div class="form-group">
                    <label for="name" data-i18n="labels.name">ŒåŒΩŒøŒºŒ± <span class="required">*</span></label>
                    <input type="text" id="name" name="name" required>
                </div>

                <div class="form-group">
                    <label for="company" data-i18n="labels.company">ŒïœÑŒ±ŒπœÅŒµŒØŒ± <span class="required">*</span></label>
                    <div class="autocomplete-container">
                        <input type="text" id="company" name="company" required placeholder="Œ†ŒªŒ∑Œ∫œÑœÅŒøŒªŒøŒ≥ŒÆœÉœÑŒµ œÑŒø œåŒΩŒøŒºŒ± œÑŒ∑œÇ ŒµœÑŒ±ŒπœÅŒµŒØŒ±œÇ..." data-i18n-placeholder="placeholders.company">
                        <div id="autocomplete-dropdown" class="autocomplete-dropdown"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="department" data-i18n="labels.department">Œ§ŒºŒÆŒºŒ±</label>
                    <input type="text" id="department" name="department" placeholder="œÄ.œá. ŒõŒøŒ≥ŒπœÉœÑŒÆœÅŒπŒø, Œ†œâŒªŒÆœÉŒµŒπœÇ" data-i18n-placeholder="placeholders.department">
                </div>

                <div class="form-group">
                    <label for="email" data-i18n="labels.email">E-Mail</label>
                    <input type="email" id="email" name="email" placeholder="ŒëŒΩ œÑŒø ŒµœÅœéœÑŒ∑ŒºŒ± œÉŒ±œÇ Œ¥ŒµŒΩ Œ±œÄŒ±ŒΩœÑŒ∑Œ∏ŒµŒØ œÄœÅŒøœÜŒøœÅŒπŒ∫Œ¨" data-i18n-placeholder="placeholders.email">
                </div>

                <div class="form-group">
                    <label for="targetSpeaker" data-i18n="labels.targetSpeaker">ŒïœÅœéœÑŒ∑œÉŒ∑ œÄœÅŒøœÇ <span class="required">*</span></label>
                    <select id="targetSpeaker" name="targetSpeaker" required>
                        <option value="" data-i18n="options.loadingSpeakers">‚è≥ Œ¶œåœÅœÑœâœÉŒ∑ ŒøŒºŒπŒªŒ∑œÑœéŒΩ...</option>
                        <option value="ŒìŒπŒ¨ŒΩŒΩŒ∑œÇ Œ†Œ±œÄŒ±Œ¥œåœÄŒøœÖŒªŒøœÇ">ŒìŒπŒ¨ŒΩŒΩŒ∑œÇ Œ†Œ±œÄŒ±Œ¥œåœÄŒøœÖŒªŒøœÇ</option>
                        <option value="ŒîŒ∑ŒºŒÆœÑœÅŒ∑œÇ Œ†Œ±œÄŒ±Œ¥œåœÄŒøœÖŒªŒøœÇ">ŒîŒ∑ŒºŒÆœÑœÅŒ∑œÇ Œ†Œ±œÄŒ±Œ¥œåœÄŒøœÖŒªŒøœÇ</option>
                        <option value="ŒúŒ±œÅŒØŒ± ŒöœâŒΩœÉœÑŒ±ŒΩœÑŒØŒΩŒøœÖ">ŒúŒ±œÅŒØŒ± ŒöœâŒΩœÉœÑŒ±ŒΩœÑŒØŒΩŒøœÖ</option>
                        <option value="ŒùŒØŒ∫ŒøœÇ ŒëŒΩœÑœâŒΩŒØŒøœÖ">ŒùŒØŒ∫ŒøœÇ ŒëŒΩœÑœâŒΩŒØŒøœÖ</option>
                        <option value="ŒÜŒΩŒΩŒ± ŒìŒµœâœÅŒ≥ŒØŒøœÖ">ŒÜŒΩŒΩŒ± ŒìŒµœâœÅŒ≥ŒØŒøœÖ</option>
                        <option value="ŒìŒµŒΩŒπŒ∫ŒÆ ŒïœÅœéœÑŒ∑œÉŒ∑ (ŒåŒªŒøŒπ)" data-i18n="options.generalQuestion">ŒìŒµŒΩŒπŒ∫ŒÆ ŒïœÅœéœÑŒ∑œÉŒ∑ (ŒåŒªŒøŒπ)</option>
                    </select>
                </div>



                <div class="form-group">
                    <label for="subject" data-i18n="labels.subject">ŒòŒ≠ŒºŒ± <span class="required">*</span></label>
                    <input type="text" id="subject" name="subject" placeholder="œÄ.œá. ŒîŒ±œÄŒ¨ŒΩŒµœÇ ŒëŒΩŒ±ŒªœâœÉŒØŒºœâŒΩ" data-i18n-placeholder="placeholders.subject" required>
                </div>

                <div class="form-group">
                    <label for="question" data-i18n="labels.question">ŒöŒµŒØŒºŒµŒΩŒø ŒïœÅœéœÑŒ∑œÉŒ∑œÇ <span class="required">*</span></label>
                    <textarea id="question" name="question" placeholder="œÄ.œá. Œ†œéœÇ Œ∫Œ¨ŒΩŒøœÖŒºŒµ Œ±ŒΩœÑŒπŒªŒøŒ≥ŒπœÉŒºŒøœçœÇ Œ≥ŒπŒ± œÑŒ± Œ±ŒΩŒ±ŒªœéœÉŒπŒºŒ± œÄŒøœÖ œáœÅŒ∑œÉŒπŒºŒøœÄŒøŒπŒøœçŒºŒµ œÉœÑŒ∑ŒΩ œÄŒ±œÅŒ±Œ≥œâŒ≥ŒÆ;" data-i18n-placeholder="placeholders.questionText" required maxlength="1500"></textarea>
                    <div class="char-counter">
                        <span id="charCount">0</span>/1500 <span data-i18n="charCounter">œáŒ±œÅŒ±Œ∫œÑŒÆœÅŒµœÇ</span>
                    </div>
                </div>

                <button type="submit" class="submit-btn" data-i18n="submitButton">
                    üì§ Œ•œÄŒøŒ≤ŒøŒªŒÆ ŒïœÅœéœÑŒ∑œÉŒ∑œÇ
                </button>
            </form>
        </div>
    </div>
<script src="/socket.io/socket.io.js"></script>

    <script>
        // Œ¶œåœÅœÑœâœÉŒ∑ ŒøŒºŒπŒªŒ∑œÑœéŒΩ Œ±œÄœå œÑŒø API
        async function loadSpeakers() {
    const select = document.getElementById('targetSpeaker');
    
    // Fallback Œ±ŒΩ Œ¥ŒµŒΩ œÖœÄŒ¨œÅœáŒµŒπ œÑŒø element
    if (!select) {
        console.error('‚ùå Speaker select element not found');
        return;
    }
    
    try {
        const response = await fetch('/api/questions/speakers');
        const data = await response.json();
        
        const selectSpeakerText = window.i18next ? window.i18next.t('options.selectSpeaker') : 'ŒïœÄŒπŒªŒ≠ŒæœÑŒµ ŒøŒºŒπŒªŒ∑œÑŒÆ...';
        select.innerHTML = `<option value="">${selectSpeakerText}</option>`;
        
        if (data.success && data.speakers) {
            data.speakers.forEach(speaker => {
                const option = document.createElement('option');
                option.value = speaker;
                option.textContent = speaker;
                select.appendChild(option);
            });
            console.log(`‚úÖ Loaded ${data.speakers.length} speakers from timeline`);
        } else {
            throw new Error('API returned no speakers');
        }
    } catch (error) {
        console.error('‚ùå Error loading speakers:', error);
        
        // FALLBACK ŒºŒµ custom dialog
        const selectSpeakerText = window.i18next ? window.i18next.t('options.selectSpeaker') : 'ŒïœÄŒπŒªŒ≠ŒæœÑŒµ ŒøŒºŒπŒªŒ∑œÑŒÆ...';
        select.innerHTML = `<option value="">${selectSpeakerText}</option>`;
        
        const fallbackSpeakers = [
            'ŒìŒµŒΩŒπŒ∫ŒÆ ŒïœÅœéœÑŒ∑œÉŒ∑ (ŒåŒªŒøŒπ)',
            'ŒìŒπŒ¨ŒΩŒΩŒ∑œÇ Œ†Œ±œÄŒ±Œ¥œåœÄŒøœÖŒªŒøœÇ',
            'ŒúŒ±œÅŒØŒ± ŒöœâŒΩœÉœÑŒ±ŒΩœÑŒØŒΩŒøœÖ',
            'ŒùŒØŒ∫ŒøœÇ ŒëŒªŒµŒæŒØŒøœÖ'
        ];
        
        fallbackSpeakers.forEach(speaker => {
            const option = document.createElement('option');
            option.value = speaker;
            option.textContent = speaker;
            select.appendChild(option);
        });
        
        console.warn('‚ö†Ô∏è Used fallback speakers due to API error');
        
        // Show custom error dialog instead of alert
        showCustomDialog('‚ö†Ô∏è Œ£œçŒΩŒ¥ŒµœÉŒ∑ ŒºŒµ Server', 'Œó œÉœçŒΩŒ¥ŒµœÉŒ∑ ŒºŒµ œÑŒøŒΩ server Œ¥ŒπŒ±Œ∫œåœÄŒ∑Œ∫Œµ œÄœÅŒøœÉœâœÅŒπŒΩŒ¨. ŒßœÅŒ∑œÉŒπŒºŒøœÄŒøŒπŒøœçŒΩœÑŒ±Œπ œÄœÅŒøŒµœÄŒπŒªŒµŒ≥ŒºŒ≠ŒΩŒøŒπ ŒøŒºŒπŒªŒ∑œÑŒ≠œÇ.', 'warning');
    }
}

        // Character counter Œ≥ŒπŒ± textarea
        const questionTextarea = document.getElementById('question');
        const charCount = document.getElementById('charCount');

        questionTextarea.addEventListener('input', function() {
            const currentLength = this.value.length;
            charCount.textContent = currentLength;
            
            if (currentLength > 450) {
                charCount.style.color = '#e74c3c';
            } else {
                charCount.style.color = '#666';
            }
        });

        // Form submission ŒºŒµ API
        document.getElementById('questionForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            // ŒïŒõŒïŒìŒßŒüŒ£ ŒëŒù Œ•Œ†ŒëŒ°ŒßŒüŒ•Œù Œ§Œë ELEMENTS
    const nameEl = document.getElementById('name');
    const companyEl = document.getElementById('company');
    const targetSpeakerEl = document.getElementById('targetSpeaker');
    
    if (!nameEl || !companyEl || !targetSpeakerEl) {
        console.error('‚ùå Form elements not found');
        alert('‚ùå Œ£œÜŒ¨ŒªŒºŒ± œÜœåœÅŒºŒ±œÇ - œÄŒ±œÅŒ±Œ∫Œ±Œªœé Œ±ŒΩŒ±ŒΩŒµœéœÉœÑŒµ œÑŒ∑ œÉŒµŒªŒØŒ¥Œ±');
        return;
    }
            
            // Œ£œÖŒªŒªŒøŒ≥ŒÆ Œ¥ŒµŒ¥ŒøŒºŒ≠ŒΩœâŒΩ œÜœåœÅŒºŒ±œÇ
const formData = {
    name: nameEl.value,           // ‚Üê ŒßœÅŒ∑œÉŒπŒºŒøœÄŒøŒπŒµŒØ œÑŒ± ŒµŒªŒµŒ≥ŒºŒ≠ŒΩŒ± elements
    company: companyEl.value,     // ‚Üê Œ±œÄœå œÄŒ¨ŒΩœâ
    department: document.getElementById('department')?.value || '',
    email: document.getElementById('email')?.value || '',
    targetSpeaker: targetSpeakerEl.value,
    subject: document.getElementById('subject')?.value || '',
    question: document.getElementById('question')?.value || ''
};

            // Validation
            if (!formData.name || !formData.company || !formData.targetSpeaker || 
                !formData.subject || !formData.question) {
                alert('‚ö†Ô∏è Œ†Œ±œÅŒ±Œ∫Œ±Œªœé œÉœÖŒºœÄŒªŒ∑œÅœéœÉœÑŒµ œåŒªŒ± œÑŒ± œÖœÄŒøœáœÅŒµœâœÑŒπŒ∫Œ¨ œÄŒµŒ¥ŒØŒ±');
                return;
            }

            try {
                // ŒëœÄŒøœÉœÑŒøŒªŒÆ œÉœÑŒø API
                const response = await fetch('/api/questions/submit', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                const result = await response.json();

                if (result.success) {
                    // ŒïœÄŒπœÑœÖœáŒØŒ±
                    document.getElementById('successMessage').style.display = 'block';
                    
                    // Reset form
                    this.reset();
                    charCount.textContent = '0';
                    
                    // Scroll to top
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                    
                    console.log('‚úÖ Question submitted successfully:', result.questionId);
                    
                    // Hide success message after 5 seconds
                    setTimeout(() => {
                        document.getElementById('successMessage').style.display = 'none';
                    }, 5000);
                } else {
                    throw new Error(result.error || 'ŒëœÄŒøœÑœÖœáŒØŒ± œÖœÄŒøŒ≤ŒøŒªŒÆœÇ');
                }
                
            } catch (error) {
                console.error('‚ùå Submission error:', error);
                alert(`‚ùå Œ£œÜŒ¨ŒªŒºŒ± œÖœÄŒøŒ≤ŒøŒªŒÆœÇ: ${error.message}`);
            }
        });


        // ‚úÖ Œ£Œ©Œ£Œ§Œü - œÄŒµœÅŒπŒºŒ≠ŒΩŒµŒπ œÄŒªŒÆœÅŒ∑ œÜœåœÅœÑœâœÉŒ∑
document.addEventListener('DOMContentLoaded', function() {
    // Œ†ŒµœÅŒπŒºŒ≠ŒΩŒµŒπ ŒªŒØŒ≥Œø Œ±Œ∫œåŒºŒ± Œ≥ŒπŒ± œÉŒπŒ≥ŒøœÖœÅŒπŒ¨
    setTimeout(() => {
        console.log('üîç DOM ready, searching for elements...');
        
        
        const select = document.getElementById('targetSpeaker');
        if (select) {
            console.log('‚úÖ Speaker select found!');
            loadSpeakers();
        } else {
            console.error('‚ùå Speaker select still not found after DOM ready');
            // ŒîŒøŒ∫ŒπŒºŒÆ ŒæŒ±ŒΩŒ¨ œÉŒµ 1 Œ¥ŒµœÖœÑŒµœÅœåŒªŒµœÄœÑŒø
            setTimeout(() => {
                loadSpeakers();
            }, 1000);
        }
    }, 100);
});
// WebSocket connection Œ≥ŒπŒ± Œ±œÖœÑœåŒºŒ±œÑŒ∑ ŒµŒΩŒ∑ŒºŒ≠œÅœâœÉŒ∑ ŒøŒºŒπŒªŒ∑œÑœéŒΩ ŒºŒµ Rate Limiting
let socket;
let lastUpdateTime = 0;
let updateTimeout = null;
const MIN_UPDATE_INTERVAL = 30000; // 30 Œ¥ŒµœÖœÑŒµœÅœåŒªŒµœÄœÑŒ± ŒºŒµœÑŒ±Œæœç updates
const MAX_RANDOM_DELAY = 10000; // 0-10 Œ¥ŒµœÖœÑŒµœÅœåŒªŒµœÄœÑŒ± random delay

// Update header logo function
function updateHeaderLogo(logoDataUrl) {
    const headerLogo = document.getElementById('header-logo');
    if (!headerLogo) {
        console.warn('Header logo element not found');
        return;
    }
    
    if (!logoDataUrl || logoDataUrl.trim() === '') {
        // Clear logo
        headerLogo.style.backgroundImage = '';
        headerLogo.style.display = 'none';
        console.log('üñºÔ∏è Header logo cleared');
    } else {
        // Set logo
        headerLogo.style.backgroundImage = `url('${logoDataUrl}')`;
        headerLogo.style.display = 'inline-block';
        console.log('üñºÔ∏è Header logo updated');
    }
}

// Update conference title function
function updateConferenceTitle(title) {
    const titleElement = document.getElementById('conference-title');
    
    if (!titleElement) {
        console.warn('Conference title element not found');
        return;
    }
    
    if (!title || title.trim() === '' || title === 'TimeCast¬Æ Pro Presentation Timer') {
        // Use fallback title
        titleElement.textContent = 'TimeCast‚Ñ¢ Pro';
        console.log('üìù Conference title reset to default');
    } else {
        // Set conference title
        titleElement.textContent = title;
        console.log('üìù Conference title updated:', title);
    }
}

// Load initial settings from server
async function loadInitialSettings() {
    try {
        const response = await fetch('/api/timer/current');
        const data = await response.json();
        
        if (data) {
            // Update logo
            if (data.logoDataUrl) {
                updateHeaderLogo(data.logoDataUrl);
                console.log('üñºÔ∏è Initial logo loaded from server');
            } else {
                console.log('üñºÔ∏è No initial logo available');
            }
            
            // Update title
            if (data.title) {
                updateConferenceTitle(data.title);
                console.log('üìù Initial title loaded from server');
            } else {
                console.log('üìù No initial title available');
            }
        }
    } catch (error) {
        console.warn('‚ö†Ô∏è Could not load initial settings:', error.message);
    }
}

// Œ£œçŒΩŒ¥ŒµœÉŒ∑ œÉœÑŒø WebSocket
function connectWebSocket() {
    socket = io();
    
    socket.on('connect', () => {
        console.log('üîå Connected to WebSocket for speaker updates');
        
        // ŒöŒëŒ§ŒëŒßŒ©Œ°ŒóŒ£Œó Œ©Œ£ QUESTIONS CLIENT
        // Œ†Œ±ŒØœÅŒΩŒøœÖŒºŒµ œÑŒø saved PC name
        const savedPcName = localStorage.getItem('pcName');
        const hostname = savedPcName && savedPcName.trim() ? savedPcName.trim() : 'Questions-Form';
        
        console.log('üîç Sending hostname to server:', hostname);
        socket.emit('registerClient', {
            type: 'questions-client',
            role: 'questions',
            hostname: hostname
        });
        
        console.log('üìù Registered as: questions-client');
    });

    // PING/PONG HANDLERS Œ≥ŒπŒ± heartbeat
    socket.on('ping', () => {
        socket.emit('pong');
    });

    socket.on('pong', () => {
        // Server received our ping
    });
    
    // Rate-limited ŒµŒΩŒ∑ŒºŒ≠œÅœâœÉŒ∑ œåœÑŒ±ŒΩ Œ±ŒªŒªŒ¨Œ∂ŒøœÖŒΩ œÑŒ± markers
    socket.on('eventMarkersUpdate', (data) => {
        const now = Date.now();
        
        console.log(`üìä Event markers update received - action: ${data.action}`);
        
        // ŒÜŒºŒµœÉŒ∑ ŒµŒΩŒ∑ŒºŒ≠œÅœâœÉŒ∑ Œ≥ŒπŒ± edit actions (œáœâœÅŒØœÇ rate limiting)
        if (data.action === 'edit') {
            console.log('üìù Marker edited - immediate speaker reload');
            
            // Cancel œÑœÖœáœåŒΩ pending update
            if (updateTimeout) {
                clearTimeout(updateTimeout);
            }
            
            loadSpeakers(); // ŒÜŒºŒµœÉŒ∑ Œ±ŒΩŒ±ŒΩŒ≠œâœÉŒ∑ Œ≥ŒπŒ± edits
            lastUpdateTime = Date.now();
            return;
        }
        
        // Rate limiting Œ≥ŒπŒ± add/delete: ŒºœåŒΩŒø Œ±ŒΩ Œ≠œáŒøœÖŒΩ œÄŒµœÅŒ¨œÉŒµŒπ 30+ Œ¥ŒµœÖœÑŒµœÅœåŒªŒµœÄœÑŒ±
        if (now - lastUpdateTime < MIN_UPDATE_INTERVAL) {
            console.log('üìä Event markers update ignored (rate limited)');
            return;
        }
        
        // Cancel œÑœÖœáœåŒΩ pending update
        if (updateTimeout) {
            clearTimeout(updateTimeout);
        }
        
        // Staggered update: random delay 0-10 Œ¥ŒµœÖœÑŒµœÅœåŒªŒµœÄœÑŒ± Œ≥ŒπŒ± add/delete
        const randomDelay = Math.random() * MAX_RANDOM_DELAY;
        
        console.log(`üìä Event markers updated - scheduling speaker reload in ${Math.round(randomDelay/1000)}s`);
        
        updateTimeout = setTimeout(() => {
            lastUpdateTime = Date.now();
            loadSpeakers(); // ŒëŒΩŒ±ŒΩŒ≠œâœÉŒ∑ ŒªŒØœÉœÑŒ±œÇ ŒøŒºŒπŒªŒ∑œÑœéŒΩ
            updateTimeout = null;
        }, randomDelay);
    });

    // Listen for settings updates (official "Apply" button clicks only)
    socket.on('settingsUpdate', (data) => {
        console.log('‚öôÔ∏è Settings update received:', data);
        
        // Update logo only on official settings apply (like timer.html)
        if (data.display && data.display.logoDataUrl !== undefined) {
            updateHeaderLogo(data.display.logoDataUrl);
        }
        
        // Update title only on official settings apply
        if (data.display && data.display.title !== undefined) {
            updateConferenceTitle(data.display.title);
        }
    });

    // Listen for full state updates
    socket.on('fullStateUpdate', (data) => {
        console.log('üîÑ Full state update received');
        
        // Update logo from full state
        if (data.displaySettings && data.displaySettings.logoDataUrl !== undefined) {
            updateHeaderLogo(data.displaySettings.logoDataUrl);
        }
        
        // DON'T update title from full state - only from settingsUpdate (Apply button)
        // This ensures consistent behavior with timer.html
        console.log('üìù Title update skipped - waiting for Apply button (settingsUpdate event)');
    });
    
    socket.on('disconnect', () => {
        console.log('üîå Disconnected from WebSocket');
        // Clear pending updates on disconnect
        if (updateTimeout) {
            clearTimeout(updateTimeout);
            updateTimeout = null;
        }
    });
}

// NoSleep Œ≥ŒπŒ± ŒΩŒ± ŒºŒ∑ŒΩ œÉŒ≤ŒÆŒΩŒµŒπ Œ∑ ŒøŒ∏œåŒΩŒ∑
const noSleep = new NoSleep();
let noSleepEnabled = false;

// ŒïŒΩŒµœÅŒ≥ŒøœÄŒøŒØŒ∑œÉŒ∑ NoSleep ŒºŒµ ŒøœÄŒøŒπŒøŒ¥ŒÆœÄŒøœÑŒµ user interaction
function enableNoSleep() {
    if (!noSleepEnabled) {
        try {
            noSleep.enable();
            noSleepEnabled = true;
            console.log('NoSleep ŒµŒΩŒµœÅŒ≥ŒøœÄŒøŒπŒÆŒ∏Œ∑Œ∫Œµ');
            
            // ŒëœÜŒ±ŒØœÅŒµœÉŒ∑ œåŒªœâŒΩ œÑœâŒΩ listeners
            document.removeEventListener('click', enableNoSleep, false);
            document.removeEventListener('touchstart', enableNoSleep, false);
            document.removeEventListener('keydown', enableNoSleep, false);
            
            // ŒïŒºœÜŒ¨ŒΩŒπœÉŒ∑ ŒºŒ∑ŒΩœçŒºŒ±œÑŒøœÇ œÉœÑŒ∑ŒΩ ŒøŒ∏œåŒΩŒ∑
            showNoSleepStatus();
        } catch (error) {
            console.error('NoSleep failed:', error);
        }
    }
}

// Œ†œÅŒøœÉŒ∏ŒÆŒ∫Œ∑ listeners Œ≥ŒπŒ± Œ¥ŒπŒ±œÜŒøœÅŒµœÑŒπŒ∫Œ¨ events
document.addEventListener('click', enableNoSleep, false);
document.addEventListener('touchstart', enableNoSleep, false);
document.addEventListener('keydown', enableNoSleep, false);

// ŒïŒπŒ¥ŒπŒ∫ŒÆ ŒµŒΩŒµœÅŒ≥ŒøœÄŒøŒØŒ∑œÉŒ∑ Œ≥ŒπŒ± iOS
if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
    console.log('iOS device detected - NoSleep will activate on first touch');
    
    // Œ†œÅœåœÉŒ∏ŒµœÑŒ∑ œÄœÅŒøœÉœÑŒ±œÉŒØŒ± Œ≥ŒπŒ± iOS
    document.addEventListener('touchend', enableNoSleep, false);
    document.addEventListener('gesturestart', enableNoSleep, false);
}

// ŒïŒºœÜŒ¨ŒΩŒπœÉŒ∑ Œ∫Œ±œÑŒ¨œÉœÑŒ±œÉŒ∑œÇ NoSleep
function showNoSleepStatus() {
    const statusDiv = document.createElement('div');
    statusDiv.style.cssText = `
        position: fixed;
        top: 5px;
        right: 5px;
        background: rgba(39, 174, 96, 0.9);
        color: white;
        padding: 5px 10px;
        border-radius: 3px;
        font-size: 12px;
        z-index: 9999;
        pointer-events: none;
    `;
    statusDiv.textContent = 'üîã Screen Lock Disabled';
    document.body.appendChild(statusDiv);
    
    // ŒëœÜŒ±ŒØœÅŒµœÉŒ∑ ŒºŒµœÑŒ¨ Œ±œÄœå 3 Œ¥ŒµœÖœÑŒµœÅœåŒªŒµœÄœÑŒ±
    setTimeout(() => {
        if (statusDiv.parentNode) {
            statusDiv.parentNode.removeChild(statusDiv);
        }
    }, 3000);
}

// ŒïœÄŒ±ŒΩŒµŒΩŒµœÅŒ≥ŒøœÄŒøŒØŒ∑œÉŒ∑ NoSleep Œ∫Œ¨Œ∏Œµ 1 ŒªŒµœÄœÑœå
setInterval(() => {
    if (noSleepEnabled && noSleep) {
        try {
            noSleep.enable();
            console.log('NoSleep reactivated - 1 minute check');
        } catch (error) {
            console.error('NoSleep reactivation failed:', error);
        }
    }
}, 60000); // ŒöŒ¨Œ∏Œµ 1 ŒªŒµœÄœÑœå

// ŒïŒ∫Œ∫ŒØŒΩŒ∑œÉŒ∑ WebSocket ŒºŒµœÑŒ¨ œÑŒø DOM ready
document.addEventListener('DOMContentLoaded', function() {
    // Œ•œÄŒ¨œÅœáœâŒΩ Œ∫œéŒ¥ŒπŒ∫Œ±œÇ...
    setTimeout(() => {
        console.log('üîç DOM ready, searching for elements...');
        
        const select = document.getElementById('targetSpeaker');
        if (select) {
            console.log('‚úÖ Speaker select found!');
            loadSpeakers();
            
            // ŒùŒïŒüŒ£: Œ£œçŒΩŒ¥ŒµœÉŒ∑ WebSocket Œ≥ŒπŒ± auto-updates
            connectWebSocket();
            
            // Load initial settings (logo + title)
            loadInitialSettings();
        } else {
            console.error('‚ùå Speaker select still not found after DOM ready');
            setTimeout(() => {
                loadSpeakers();
                connectWebSocket(); // ŒöŒ±Œπ ŒµŒ¥œé
                loadInitialSettings(); // ŒöŒ±Œπ ŒµŒ¥œé
            }, 1000);
        }
    }, 100);
});

// Right-click context menu functionality
document.addEventListener('DOMContentLoaded', () => {
    // Right-click context menu events
    document.addEventListener('contextmenu', function(e) {
        e.preventDefault();
        const contextMenu = document.getElementById('contextMenu');
        contextMenu.style.display = 'block';
        contextMenu.style.left = e.pageX + 'px';
        contextMenu.style.top = e.pageY + 'px';
    });
    
    // Hide context menu on click elsewhere
    document.addEventListener('click', function(e) {
        const contextMenu = document.getElementById('contextMenu');
        if (!contextMenu.contains(e.target)) {
            contextMenu.style.display = 'none';
        }
    });
    
    // Set PC Name handler
    document.getElementById('setPcName').addEventListener('click', function() {
        const currentName = localStorage.getItem('pcName') || '';
        const dialog = document.getElementById('pcNameDialog');
        const input = document.getElementById('pcNameInput');
        
        input.value = currentName;
        dialog.style.display = 'flex';
        input.focus();
        input.select();
        
        document.getElementById('contextMenu').style.display = 'none';
    });
    
    // PC Name dialog handlers
    document.getElementById('pcNameOk').addEventListener('click', function() {
        const input = document.getElementById('pcNameInput');
        const newName = input.value.trim();
        
        if (newName) {
            localStorage.setItem('pcName', newName);
            console.log('‚úÖ PC Name saved:', newName);
            
            // ŒïœÄŒ±ŒΩŒ±œÉœçŒΩŒ¥ŒµœÉŒ∑ ŒºŒµ ŒΩŒ≠Œø hostname
            if (typeof socket !== 'undefined' && socket && socket.connected) {
                socket.emit('updateHostname', { hostname: newName });
                console.log('üîÑ Sent hostname update to server:', newName);
            }
        }
        
        document.getElementById('pcNameDialog').style.display = 'none';
    });
    
    document.getElementById('pcNameCancel').addEventListener('click', function() {
        document.getElementById('pcNameDialog').style.display = 'none';
    });
    
    // Enter key support
    document.getElementById('pcNameInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            document.getElementById('pcNameOk').click();
        } else if (e.key === 'Escape') {
            document.getElementById('pcNameCancel').click();
        }
    });
});

// Custom dialog function
function showCustomDialog(title, message, type = 'info') {
    // Remove any existing dialog
    const existingDialog = document.getElementById('customDialog');
    if (existingDialog) {
        existingDialog.remove();
    }
    
    // Create dialog
    const dialog = document.createElement('div');
    dialog.id = 'customDialog';
    dialog.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 10000;
        animation: fadeIn 0.2s ease;
    `;
    
    // Icon based on type
    let icon = 'üí¨';
    let titleColor = '#3498db';
    if (type === 'warning') {
        icon = '‚ö†Ô∏è';
        titleColor = '#f39c12';
    } else if (type === 'error') {
        icon = '‚ùå';
        titleColor = '#e74c3c';
    }
    
    dialog.innerHTML = `
        <div style="
            background: #2c3e50;
            padding: 25px;
            border-radius: 8px;
            color: white;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
            max-width: 400px;
            margin: 20px;
        ">
            <h3 style="margin: 0 0 15px 0; color: ${titleColor}; font-size: 18px;">${icon} ${title}</h3>
            <p style="margin: 0 0 20px 0; line-height: 1.4; color: #ecf0f1; font-size: 14px;">${message}</p>
            <button onclick="closeCustomDialog()" style="
                background: #27ae60;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 4px;
                cursor: pointer;
                font-size: 14px;
                transition: background 0.2s;
            " onmouseover="this.style.background='#229954'" onmouseout="this.style.background='#27ae60'">
                OK
            </button>
        </div>
    `;
    
    // Add CSS animation
    const style = document.createElement('style');
    style.textContent = `
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    `;
    document.head.appendChild(style);
    
    document.body.appendChild(dialog);
    
    // Auto-close after 5 seconds
    setTimeout(() => {
        closeCustomDialog();
    }, 5000);
}

function closeCustomDialog() {
    const dialog = document.getElementById('customDialog');
    if (dialog) {
        dialog.style.animation = 'fadeOut 0.2s ease';
        setTimeout(() => {
            dialog.remove();
        }, 200);
    }
}

// ŒìŒïŒúŒó API Integration Œ≥ŒπŒ± Company Autocomplete
let searchTimeout;
let selectedCompanyIndex = -1;
let companiesCache = [];
let searchCache = new Map(); // Client-side cache Œ≥ŒπŒ± 8 calls/min rate limit

// Search companies Œ±œÄœå ŒìŒïŒúŒó API (ŒïŒªŒªŒ¨Œ¥Œ±)
async function searchGemiCompanies(query) {
    try {
        console.log('üá¨üá∑ ŒìŒïŒúŒó API call Œ≥ŒπŒ±:', query);
        const response = await fetch(`/api/gemi/search-companies?name=${encodeURIComponent(query)}`);

        if (!response.ok) {
            throw new Error(`HTTP ${response.status}`);
        }

        const data = await response.json();
        
        if (!data.success) {
            throw new Error(data.error || 'API error');
        }
        
        // Add country flag and source to companies, prioritize distinctive title
        return (data.companies || []).map(company => ({
            ...company,
            // Use distinctive title (coTitlesEl) if available, fallback to company name (coNameEl)
            name: (company.coTitlesEl && company.coTitlesEl.length > 0) ? company.coTitlesEl[0] : company.coNameEl,
            originalName: company.coNameEl, // Keep original name for reference
            distinctiveTitle: company.coTitlesEl ? company.coTitlesEl[0] : null,
            country: 'Greece',
            source: 'ŒìŒïŒúŒó',
            flag: 'üá¨üá∑'
        }));
        
    } catch (error) {
        console.error('‚ùå ŒìŒïŒúŒó API Error:', error);
        return [];
    }
}

// Search companies Œ±œÄœå INSEE API (ŒìŒ±ŒªŒªŒØŒ±)
async function searchInseeCompanies(query) {
    try {
        console.log('üá´üá∑ INSEE API call Œ≥ŒπŒ±:', query);
        const response = await fetch(`/api/insee/search-companies?name=${encodeURIComponent(query)}`);

        if (!response.ok) {
            throw new Error(`HTTP ${response.status}`);
        }

        const data = await response.json();
        
        if (!data.success) {
            throw new Error(data.error || 'API error');
        }
        
        // Add country flag and source to companies  
        return (data.companies || []).map(company => ({
            ...company,
            country: 'France',
            source: 'INSEE',
            flag: 'üá´üá∑'
        }));
        
    } catch (error) {
        console.error('‚ùå INSEE API Error:', error);
        return [];
    }
}

// Search companies Œ±œÄœå Danish CVR API
async function searchDanishCompanies(query) {
    try {
        console.log('üá©üá∞ CVR API call Œ≥ŒπŒ±:', query);
        const response = await fetch(`/api/cvr/search-companies?name=${encodeURIComponent(query)}`);

        if (!response.ok) {
            throw new Error(`HTTP ${response.status}`);
        }

        const data = await response.json();
        
        if (!data.success) {
            throw new Error(data.error || 'API error');
        }
        
        // Add country flag and source to companies  
        return (data.companies || []).map(company => ({
            ...company,
            country: 'Denmark',
            source: 'CVR',
            flag: 'üá©üá∞'
        }));
        
    } catch (error) {
        console.error('‚ùå CVR API Error:', error);
        return [];
    }
}

// Finnish YTJ API search
async function searchYtjCompanies(query) {
    try {
        console.log('üá´üáÆ YTJ API call Œ≥ŒπŒ±:', query);
        const response = await fetch(`/api/ytj/search-companies?name=${encodeURIComponent(query)}`);

        if (!response.ok) {
            throw new Error(`HTTP ${response.status}`);
        }

        const data = await response.json();
        
        if (!data.success || !data.companies) {
            console.warn('üá´üáÆ YTJ API returned no results');
            return [];
        }
        
        console.log(`‚úÖ YTJ API ŒµœÄŒ≠œÉœÑœÅŒµœàŒµ ${data.companies.length} Œ±œÄŒøœÑŒµŒªŒ≠œÉŒºŒ±œÑŒ±`);
        
        return data.companies.map(company => ({
            name: company.name,
            address: company.address || '',
            businessId: company.businessId || '',
            country: 'Finland',
            source: 'YTJ',
            flag: 'üá´üáÆ'
        }));
        
    } catch (error) {
        console.error('‚ùå YTJ API Error:', error);
        return [];
    }
}

// Dutch KVK API removed - test API only contains dummy data


// Main dual search function (ŒìŒïŒúŒó + INSEE)
async function searchCompanies(query) {
    if (query.length < 3) {
        hideAutocomplete();
        return;
    }

    const dropdown = document.getElementById('autocomplete-dropdown');
    
    // ŒàŒªŒµŒ≥œáŒøœÇ cache œÄœÅœéœÑŒ± ŒºŒµ language-specific key
    const cacheKey = `${currentFormLanguage}-${query.toLowerCase()}`;
    if (searchCache.has(cacheKey)) {
        console.log(`üì¶ Cache hit Œ≥ŒπŒ± ${currentFormLanguage}:`, query);
        companiesCache = searchCache.get(cacheKey);
        displayCompanySuggestions(companiesCache);
        dropdown.style.display = 'block';
        return;
    }
    
    // Show appropriate loading message Œ≤Œ¨œÉŒµŒπ Œ≥ŒªœéœÉœÉŒ±œÇ
    const loadingMessages = {
        'el': 'üîç ŒëŒΩŒ±Œ∂ŒÆœÑŒ∑œÉŒ∑ œÉœÑŒø ŒµŒªŒªŒ∑ŒΩŒπŒ∫œå ŒìŒïŒúŒó...',
        'fr': 'üîç Recherche dans INSEE France...',
        'da': 'üîç S√∏gning i dansk CVR...',
        'fi': 'üîç Haku suomalaisesta YTJ:st√§...',
        'en': 'üîç Company search not available',
        'de': 'üîç Unternehmenssuche nicht verf√ºgbar',
        'es': 'üîç B√∫squeda de empresas no disponible',
        'it': 'üîç Ricerca aziende non disponibile',
        'uk': 'üîç –ü–æ—à—É–∫ –∫–æ–º–ø–∞–Ω—ñ–π –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π',
        'nl': 'üîç Bedrijfszoeken niet beschikbaar',
        'pt': 'üîç Pesquisa de empresas n√£o dispon√≠vel',
        'ro': 'üîç CƒÉutarea companiilor nu este disponibilƒÉ',
        'hr': 'üîç Pretra≈æivanje tvrtki nije dostupno',
        'pl': 'üîç Wyszukiwanie firm niedostƒôpne',
        'lv': 'üîç Uz≈Üƒìmumu meklƒì≈°ana nav pieejama',
        'sl': 'üîç Iskanje podjetij ni na voljo',
        'et': 'üîç Ettev√µtete otsing pole saadaval',
        'sv': 'üîç F√∂retagss√∂kning inte tillg√§nglig',
        'cs': 'üîç Vyhled√°v√°n√≠ spoleƒçnost√≠ nen√≠ dostupn√©',
        'hu': 'üîç C√©glek√©rdez√©s nem el√©rhet≈ë',
        'lt': 'üîç ƒÆmoni≈≥ paie≈°ka nepasiekiama',
        'sk': 'üîç Vyhƒæad√°vanie spoloƒçnost√≠ nie je dostupn√©',
        'bg': 'üîç –¢—ä—Ä—Å–µ–Ω–µ –Ω–∞ –∫–æ–º–ø–∞–Ω–∏–∏ –Ω–µ –µ –Ω–∞–ª–∏—á–Ω–æ',
        'mt': 'üîç Tfittxija tal-kumpaniji mhix disponibbli'
    };
    dropdown.innerHTML = `<div class="loading-indicator">${loadingMessages[currentFormLanguage] || loadingMessages['el']}</div>`;
    dropdown.style.display = 'block';

    try {
        let companies = [];
        
        // Language-specific API calls
        if (currentFormLanguage === 'el') {
            console.log('üá¨üá∑ ŒìŒïŒúŒó search Œ≥ŒπŒ±:', query);
            companies = await searchGemiCompanies(query);
            console.log(`‚úÖ Greek companies found: ${companies.length}`);
        } else if (currentFormLanguage === 'fr') {
            console.log('üá´üá∑ INSEE search Œ≥ŒπŒ±:', query);
            companies = await searchInseeCompanies(query);
            console.log(`‚úÖ French companies found: ${companies.length}`);
        } else if (currentFormLanguage === 'en') {
            // English fallback - no company search
            console.log('üá∫üá∏ English: No company search available');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">Company search not available in English</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        } else if (currentFormLanguage === 'de') {
            // German fallback - no company search
            console.log('üá©üá™ Deutsch: Keine Unternehmenssuche verf√ºgbar');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">Unternehmenssuche nicht verf√ºgbar auf Deutsch</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        } else if (currentFormLanguage === 'es') {
            // Spanish fallback - no company search
            console.log('üá™üá∏ Espa√±ol: B√∫squeda de empresas no disponible');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">B√∫squeda de empresas no disponible en espa√±ol</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        } else if (currentFormLanguage === 'it') {
            // Italian fallback - no company search
            console.log('üáÆüáπ Italiano: Ricerca aziende non disponibile');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">Ricerca aziende non disponibile in italiano</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        } else if (currentFormLanguage === 'da') {
            // Danish - CVR API search
            console.log('üá©üá∞ Danish: CVR API search for:', query);
            companies = await searchDanishCompanies(query);
        } else if (currentFormLanguage === 'uk') {
            // Ukrainian fallback - no company search API available yet
            console.log('üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞: –ü–æ—à—É–∫ –∫–æ–º–ø–∞–Ω—ñ–π –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">–ü–æ—à—É–∫ –∫–æ–º–ø–∞–Ω—ñ–π –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é –º–æ–≤–æ—é</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        } else if (currentFormLanguage === 'nl') {
            // Dutch fallback - test API only contains dummy data, not real companies
            console.log('üá≥üá± Nederlands: Bedrijfszoeken niet beschikbaar');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">Bedrijfszoeken niet beschikbaar in het Nederlands</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        } else if (currentFormLanguage === 'pt') {
            // Portuguese fallback - no free API available
            console.log('üáµüáπ Portugu√™s: Pesquisa de empresas n√£o dispon√≠vel');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">Pesquisa de empresas n√£o dispon√≠vel em portugu√™s</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        } else if (currentFormLanguage === 'es') {
            // Spanish fallback - no company search
            console.log('üá™üá∏ Espa√±ol: B√∫squeda de empresas no disponible');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">B√∫squeda de empresas no disponible en espa√±ol</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        } else if (currentFormLanguage === 'it') {
            // Italian fallback - no company search
            console.log('üáÆüáπ Italiano: Ricerca aziende non disponibile');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">Ricerca aziende non disponibile in italiano</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        } else if (currentFormLanguage === 'ro') {
            // Romanian fallback - no free API available
            console.log('üá∑üá¥ Rom√¢nƒÉ: CƒÉutare companii nu este disponibilƒÉ');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">CƒÉutarea companiilor nu este disponibilƒÉ √Æn rom√¢nƒÉ</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        } else if (currentFormLanguage === 'hr') {
            // Croatian fallback - no free API available
            console.log('üá≠üá∑ Hrvatski: Pretra≈æivanje tvrtki nije dostupno');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">Pretra≈æivanje tvrtki nije dostupno na hrvatskom</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        } else if (currentFormLanguage === 'pl') {
            // Polish fallback - no free API available
            console.log('üáµüá± Polski: Wyszukiwanie firm nie jest dostƒôpne');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">Wyszukiwanie firm nie jest dostƒôpne po polsku</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        } else if (currentFormLanguage === 'lv') {
            // Latvian fallback - no free API available
            console.log('üá±üáª Latvie≈°u: Uz≈Üƒìmumu meklƒì≈°ana nav pieejama');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">Uz≈Üƒìmumu meklƒì≈°ana nav pieejama latvie≈°u valodƒÅ</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        } else if (currentFormLanguage === 'sl') {
            // Slovenian fallback - no free API available
            console.log('üá∏üáÆ Sloven≈°ƒçina: Iskanje podjetij ni na voljo');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">Iskanje podjetij ni na voljo v sloven≈°ƒçini</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        } else if (currentFormLanguage === 'et') {
            // Estonian fallback - no free API available
            console.log('üá™üá™ Eesti: Ettev√µtete otsing pole saadaval');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">Ettev√µtete otsing pole eesti keeles saadaval</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        } else if (currentFormLanguage === 'fi') {
            console.log('üá´üáÆ YTJ search Œ≥ŒπŒ±:', query);
            companies = await searchYtjCompanies(query);
            console.log(`‚úÖ Finnish companies found: ${companies.length}`);
        } else if (currentFormLanguage === 'sv') {
            // Swedish fallback - no free API available
            console.log('üá∏üá™ Svenska: F√∂retagss√∂kning inte tillg√§nglig');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">F√∂retagss√∂kning inte tillg√§nglig p√• svenska</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        } else if (currentFormLanguage === 'cs') {
            // Czech fallback - no free API available
            console.log('üá®üáø ƒåe≈°tina: Vyhled√°v√°n√≠ spoleƒçnost√≠ nen√≠ dostupn√©');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">Vyhled√°v√°n√≠ spoleƒçnost√≠ nen√≠ dostupn√© v ƒçe≈°tinƒõ</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        } else if (currentFormLanguage === 'hu') {
            // Hungarian fallback - no free API available
            console.log('üá≠üá∫ Magyar: C√©glek√©rdez√©s nem el√©rhet≈ë');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">C√©glek√©rdez√©s nem el√©rhet≈ë magyar nyelven</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        } else if (currentFormLanguage === 'lt') {
            // Lithuanian fallback - no free API available
            console.log('üá±üáπ Lietuvi≈≥: ƒÆmoni≈≥ paie≈°ka nepasiekiama');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">ƒÆmoni≈≥ paie≈°ka nepasiekiama lietuvi≈≥ kalba</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        } else if (currentFormLanguage === 'sk') {
            // Slovak fallback - no free API available
            console.log('üá∏üá∞ Slovenƒçina: Vyhƒæad√°vanie spoloƒçnost√≠ nie je dostupn√©');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">Vyhƒæad√°vanie spoloƒçnost√≠ nie je dostupn√© v slovenƒçine</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        } else if (currentFormLanguage === 'bg') {
            // Bulgarian fallback - no free API available
            console.log('üáßüá¨ –ë—ä–ª–≥–∞—Ä—Å–∫–∏: –¢—ä—Ä—Å–µ–Ω–µ –Ω–∞ –∫–æ–º–ø–∞–Ω–∏–∏ –Ω–µ –µ –Ω–∞–ª–∏—á–Ω–æ');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">–¢—ä—Ä—Å–µ–Ω–µ –Ω–∞ –∫–æ–º–ø–∞–Ω–∏–∏ –Ω–µ –µ –Ω–∞–ª–∏—á–Ω–æ –Ω–∞ –±—ä–ª–≥–∞—Ä—Å–∫–∏</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        } else if (currentFormLanguage === 'mt') {
            // Maltese fallback - no free API available
            console.log('üá≤üáπ Malti: Tfittxija tal-kumpaniji mhix disponibbli');
            companies = [];
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">Tfittxija tal-kumpaniji mhix disponibbli bil-Malti</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        }
        
        if (companies.length === 0) {
            dropdown.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">ŒîŒµŒΩ Œ≤œÅŒ≠Œ∏Œ∑Œ∫Œ±ŒΩ ŒµœÑŒ±ŒπœÅŒµŒØŒµœÇ / No companies found</div>';
            setTimeout(() => hideAutocomplete(), 2000);
            return;
        }
        
        companiesCache = companies;
        
        // ŒëœÄŒøŒ∏ŒÆŒ∫ŒµœÖœÉŒ∑ œÉœÑŒø cache ŒºŒµ 5-minute TTL
        searchCache.set(cacheKey, companiesCache);
        setTimeout(() => searchCache.delete(cacheKey), 5 * 60 * 1000);
        
        displayCompanySuggestions(companiesCache);
        
    } catch (error) {
        console.error('‚ùå Company Search Error:', error);
        dropdown.innerHTML = '<div class="no-results">‚ùå Œ£œÜŒ¨ŒªŒºŒ± Œ±ŒΩŒ±Œ∂ŒÆœÑŒ∑œÉŒ∑œÇ - Œ¥ŒøŒ∫ŒπŒºŒ¨œÉœÑŒµ ŒæŒ±ŒΩŒ¨</div>';
    }
}

function displayCompanySuggestions(companies) {
    const dropdown = document.getElementById('autocomplete-dropdown');
    selectedCompanyIndex = -1;
    
    if (!companies || companies.length === 0) {
        dropdown.innerHTML = '<div class="no-results">‚ùå ŒîŒµŒΩ Œ≤œÅŒ≠Œ∏Œ∑Œ∫Œ±ŒΩ ŒµœÑŒ±ŒπœÅŒµŒØŒµœÇ</div>';
        return;
    }

    const html = companies.map((company, index) => {
        // Handle both ŒìŒïŒúŒó and INSEE formats
        const name = company.coNameEl || company.name || 'ŒÜŒ≥ŒΩœâœÉœÑŒø œåŒΩŒøŒºŒ±';
        const city = company.city || '';
        const flag = company.flag || 'üè¢';
        const source = company.source || '';
        
        let details = [];
        
        if (company.source === 'ŒìŒïŒúŒó') {
            // Greek company format
            const legalType = company.legalType?.descr || '';
            const afm = company.afm || '';
            
            if (legalType) details.push(legalType);
            if (city) details.push(city);  
            if (afm) details.push(`ŒëŒ¶Œú: ${afm}`);
        } else if (company.source === 'INSEE') {
            // French company format
            const postalCode = company.postalCode || '';
            const siret = company.siret || '';
            
            if (city && postalCode) details.push(`${city} ${postalCode}`);
            else if (city) details.push(city);
            if (siret) details.push(`SIRET: ${siret}`);
        }
        
        return `
            <div class="autocomplete-item" data-index="${index}">
                <div class="company-name">${flag} ${name} <span class="company-source">(${source})</span></div>
                ${details.length > 0 ? `<div class="company-details">${details.join(' ‚Ä¢ ')}</div>` : ''}
            </div>
        `;
    }).join('');

    dropdown.innerHTML = html;
    
    // Add click event listeners
    dropdown.querySelectorAll('.autocomplete-item').forEach(item => {
        item.addEventListener('click', () => {
            const index = parseInt(item.getAttribute('data-index'));
            selectCompany(companies[index]);
        });
    });
}

function selectCompany(company) {
    const input = document.getElementById('company');
    
    // Handle both ŒìŒïŒúŒó and INSEE formats
    const companyName = company.coNameEl || company.name || 'ŒÜŒ≥ŒΩœâœÉœÑŒø œåŒΩŒøŒºŒ±';
    input.value = companyName;
    
    hideAutocomplete();
}

function hideAutocomplete() {
    const dropdown = document.getElementById('autocomplete-dropdown');
    dropdown.style.display = 'none';
    selectedCompanyIndex = -1;
}

function highlightCompany(index) {
    const items = document.querySelectorAll('.autocomplete-item');
    
    // Remove previous highlight
    items.forEach(item => item.classList.remove('highlighted'));
    
    // Add new highlight
    if (index >= 0 && index < items.length) {
        selectedCompanyIndex = index;
        items[index].classList.add('highlighted');
        items[index].scrollIntoView({ block: 'nearest' });
    }
}

// Setup autocomplete event listeners
document.addEventListener('DOMContentLoaded', function() {
    const companyInput = document.getElementById('company');
    
    if (companyInput) {
        // Input event for search
        companyInput.addEventListener('input', (e) => {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                searchCompanies(e.target.value.trim());
            }, 800); // 800ms debounce Œ≥ŒπŒ± rate limiting
        });

        // Keyboard navigation
        companyInput.addEventListener('keydown', (e) => {
            const dropdown = document.getElementById('autocomplete-dropdown');
            const items = dropdown.querySelectorAll('.autocomplete-item');
            
            if (dropdown.style.display === 'none' || items.length === 0) return;
            
            switch (e.key) {
                case 'ArrowDown':
                    e.preventDefault();
                    highlightCompany(selectedCompanyIndex + 1);
                    break;
                case 'ArrowUp':
                    e.preventDefault();
                    highlightCompany(selectedCompanyIndex - 1);
                    break;
                case 'Enter':
                    e.preventDefault();
                    if (selectedCompanyIndex >= 0 && companiesCache[selectedCompanyIndex]) {
                        selectCompany(companiesCache[selectedCompanyIndex]);
                    }
                    break;
                case 'Escape':
                    hideAutocomplete();
                    break;
            }
        });

        // Hide on focus loss
        companyInput.addEventListener('blur', () => {
            // Delay hiding to allow click events
            setTimeout(hideAutocomplete, 150);
        });

        // Show dropdown on focus if has content
        companyInput.addEventListener('focus', () => {
            if (companyInput.value.trim().length >= 3) {
                searchCompanies(companyInput.value.trim());
            }
        });
    }

    // Hide dropdown when clicking outside
    document.addEventListener('click', (e) => {
        const container = e.target.closest('.autocomplete-container');
        if (!container) {
            hideAutocomplete();
        }
    });
});

    </script>

<!-- i18next Internationalization -->
<script src="https://cdn.jsdelivr.net/npm/i18next@23.12.2/i18next.min.js"></script>

<script>
// Language management for Questions Form
let currentFormLanguage = 'el'; // Default to Greek

// Load language preference from localStorage
function loadFormLanguage() {
    const saved = localStorage.getItem('qform-language');
    if (saved && ['el', 'en', 'fr', 'de', 'es', 'it'].includes(saved)) {
        currentFormLanguage = saved;
    }
}

// Save language preference to localStorage
function saveFormLanguage(lang) {
    localStorage.setItem('qform-language', lang);
}

// Translation resources
const formTranslations = {
    el: {
        title: "ŒïœÅœâœÑŒÆœÉŒµŒπœÇ œÄœÅŒøœÇ ŒüŒºŒπŒªŒ∑œÑŒ≠œÇ",
        subtitle: "Œ•œÄŒøŒ≤Œ¨ŒªŒµœÑŒµ œÑŒ∑ŒΩ ŒµœÅœéœÑŒ∑œÉŒÆ œÉŒ±œÇ",
        successMessage: "‚úÖ Œó ŒµœÅœéœÑŒ∑œÉŒÆ œÉŒ±œÇ œÖœÄŒøŒ≤ŒªŒÆŒ∏Œ∑Œ∫Œµ ŒµœÄŒπœÑœÖœáœéœÇ! ŒòŒ± ŒµŒæŒµœÑŒ±œÉœÑŒµŒØ Œ±œÄœå œÑŒ∑ Œ¥ŒπŒøœÅŒ≥Œ¨ŒΩœâœÉŒ∑.",
        labels: {
            name: "ŒåŒΩŒøŒºŒ± *",
            company: "ŒïœÑŒ±ŒπœÅŒµŒØŒ± *", 
            department: "Œ§ŒºŒÆŒºŒ±",
            email: "E-Mail",
            targetSpeaker: "ŒïœÅœéœÑŒ∑œÉŒ∑ œÄœÅŒøœÇ *",
            subject: "ŒòŒ≠ŒºŒ± *",
            question: "ŒöŒµŒØŒºŒµŒΩŒø ŒïœÅœéœÑŒ∑œÉŒ∑œÇ *"
        },
        placeholders: {
            company: "Œ†ŒªŒ∑Œ∫œÑœÅŒøŒªŒøŒ≥ŒÆœÉœÑŒµ œÑŒø œåŒΩŒøŒºŒ± œÑŒ∑œÇ ŒµœÑŒ±ŒπœÅŒµŒØŒ±œÇ...",
            department: "œÄ.œá. ŒõŒøŒ≥ŒπœÉœÑŒÆœÅŒπŒø, Œ†œâŒªŒÆœÉŒµŒπœÇ",
            email: "ŒëŒΩ œÑŒø ŒµœÅœéœÑŒ∑ŒºŒ± œÉŒ±œÇ Œ¥ŒµŒΩ Œ±œÄŒ±ŒΩœÑŒ∑Œ∏ŒµŒØ œÄœÅŒøœÜŒøœÅŒπŒ∫Œ¨",
            subject: "œÄ.œá. ŒîŒ±œÄŒ¨ŒΩŒµœÇ ŒëŒΩŒ±ŒªœâœÉŒØŒºœâŒΩ",
            questionText: "œÄ.œá. Œ†œéœÇ Œ∫Œ¨ŒΩŒøœÖŒºŒµ Œ±ŒΩœÑŒπŒªŒøŒ≥ŒπœÉŒºŒøœçœÇ Œ≥ŒπŒ± œÑŒ± Œ±ŒΩŒ±ŒªœéœÉŒπŒºŒ± œÄŒøœÖ œáœÅŒ∑œÉŒπŒºŒøœÄŒøŒπŒøœçŒºŒµ œÉœÑŒ∑ŒΩ œÄŒ±œÅŒ±Œ≥œâŒ≥ŒÆ;"
        },
        options: {
            loadingSpeakers: "‚è≥ Œ¶œåœÅœÑœâœÉŒ∑ ŒøŒºŒπŒªŒ∑œÑœéŒΩ...",
            generalQuestion: "ŒìŒµŒΩŒπŒ∫ŒÆ ŒïœÅœéœÑŒ∑œÉŒ∑ (ŒåŒªŒøŒπ)",
            selectSpeaker: "ŒïœÄŒπŒªŒ≠ŒæœÑŒµ ŒøŒºŒπŒªŒ∑œÑŒÆ..."
        },
        charCounter: "œáŒ±œÅŒ±Œ∫œÑŒÆœÅŒµœÇ",
        submitButton: "üì§ Œ•œÄŒøŒ≤ŒøŒªŒÆ ŒïœÅœéœÑŒ∑œÉŒ∑œÇ"
    },
    en: {
        title: "Questions to Speakers",
        subtitle: "Submit your question",
        successMessage: "‚úÖ Your question has been submitted successfully! It will be reviewed by the organizers.",
        labels: {
            name: "Name *",
            company: "Company *",
            department: "Department", 
            email: "E-Mail",
            targetSpeaker: "Question to *",
            subject: "Subject *",
            question: "Question Text *"
        },
        placeholders: {
            company: "Type the company name...",
            department: "e.g. Accounting, Sales",
            email: "If your question is not answered verbally",
            subject: "e.g. Consumables Expenses",
            questionText: "e.g. How do we account for consumables used in production?"
        },
        options: {
            loadingSpeakers: "‚è≥ Loading speakers...",
            generalQuestion: "General Question (All)",
            selectSpeaker: "Select speaker..."
        },
        charCounter: "characters", 
        submitButton: "üì§ Submit Question"
    },
    fr: {
        title: "Questions aux Intervenants",
        subtitle: "Soumettez votre question",
        successMessage: "‚úÖ Votre question a √©t√© soumise avec succ√®s ! Elle sera examin√©e par les organisateurs.",
        labels: {
            name: "Nom *",
            company: "Entreprise *",
            department: "D√©partement", 
            email: "E-Mail",
            targetSpeaker: "Question √† *",
            subject: "Sujet *",
            question: "Texte de la Question *"
        },
        placeholders: {
            company: "Tapez le nom de l'entreprise...",
            department: "ex. Comptabilit√©, Ventes",
            email: "Si votre question n'est pas r√©pondue oralement",
            subject: "ex. D√©penses de Consommables",
            questionText: "ex. Comment comptabilisons-nous les consommables utilis√©s en production ?"
        },
        options: {
            loadingSpeakers: "‚è≥ Chargement des intervenants...",
            generalQuestion: "Question G√©n√©rale (Tous)",
            selectSpeaker: "S√©lectionner un intervenant..."
        },
        charCounter: "caract√®res", 
        submitButton: "üì§ Soumettre la Question"
    },
    de: {
        title: "Fragen an Referenten",
        subtitle: "Stellen Sie Ihre Frage",
        successMessage: "‚úÖ Ihre Frage wurde erfolgreich eingereicht! Sie wird von den Organisatoren gepr√ºft.",
        labels: {
            name: "Name *",
            company: "Unternehmen *",
            department: "Abteilung", 
            email: "E-Mail",
            targetSpeaker: "Frage an *",
            subject: "Betreff *",
            question: "Fragetext *"
        },
        placeholders: {
            company: "Geben Sie den Firmennamen ein...",
            department: "z.B. Buchhaltung, Vertrieb",
            email: "Falls Ihre Frage nicht m√ºndlich beantwortet wird",
            subject: "z.B. Verbrauchsmaterialkosten",
            questionText: "z.B. Wie verbuchen wir Verbrauchsmaterialien, die in der Produktion verwendet werden?"
        },
        options: {
            loadingSpeakers: "‚è≥ Referenten werden geladen...",
            generalQuestion: "Allgemeine Frage (Alle)",
            selectSpeaker: "Referenten ausw√§hlen..."
        },
        charCounter: "Zeichen", 
        submitButton: "üì§ Frage Einreichen"
    },
    es: {
        title: "Preguntas a los Ponentes",
        subtitle: "Env√≠a tu pregunta",
        successMessage: "‚úÖ ¬°Tu pregunta ha sido enviada exitosamente! Ser√° revisada por los organizadores.",
        labels: {
            name: "Nombre *",
            company: "Empresa *",
            department: "Departamento", 
            email: "E-Mail",
            targetSpeaker: "Pregunta para *",
            subject: "Asunto *",
            question: "Texto de la Pregunta *"
        },
        placeholders: {
            company: "Escriba el nombre de la empresa...",
            department: "ej. Contabilidad, Ventas",
            email: "Si tu pregunta no es respondida verbalmente",
            subject: "ej. Gastos de Suministros",
            questionText: "ej. ¬øC√≥mo contabilizamos los suministros utilizados en la producci√≥n?"
        },
        options: {
            loadingSpeakers: "‚è≥ Cargando ponentes...",
            generalQuestion: "Pregunta General (Todos)",
            selectSpeaker: "Seleccionar ponente..."
        },
        charCounter: "caracteres", 
        submitButton: "üì§ Enviar Pregunta"
    },
    it: {
        title: "Domande ai Relatori",
        subtitle: "Invia la tua domanda",
        successMessage: "‚úÖ La tua domanda √® stata inviata con successo! Sar√† esaminata dagli organizzatori.",
        labels: {
            name: "Nome *",
            company: "Azienda *",
            department: "Dipartimento", 
            email: "E-Mail",
            targetSpeaker: "Domanda per *",
            subject: "Oggetto *",
            question: "Testo della Domanda *"
        },
        placeholders: {
            company: "Digita il nome dell'azienda...",
            department: "es. Contabilit√†, Vendite",
            email: "Se la tua domanda non riceve risposta verbale",
            subject: "es. Spese per Materiali di Consumo",
            questionText: "es. Come contabilizziamo i materiali di consumo utilizzati nella produzione?"
        },
        options: {
            loadingSpeakers: "‚è≥ Caricamento relatori...",
            generalQuestion: "Domanda Generale (Tutti)",
            selectSpeaker: "Seleziona relatore..."
        },
        charCounter: "caratteri", 
        submitButton: "üì§ Invia Domanda"
    },
    da: {
        title: "Sp√∏rgsm√•l til Talere",
        subtitle: "Indsend dit sp√∏rgsm√•l",
        successMessage: "‚úÖ Dit sp√∏rgsm√•l er indsendt! Det vil blive gennemg√•et af arrang√∏rerne.",
        labels: {
            name: "Navn *",
            company: "Virksomhed *",
            department: "Afdeling", 
            email: "E-Mail",
            targetSpeaker: "Sp√∏rgsm√•l til *",
            subject: "Emne *",
            question: "Sp√∏rgsm√•lstekst *"
        },
        placeholders: {
            company: "Indtast virksomhedens navn...",
            department: "f.eks. Regnskab, Salg",
            email: "Hvis dit sp√∏rgsm√•l ikke besvares mundtligt",
            subject: "f.eks. Forbrugsudgifter",
            questionText: "f.eks. Hvordan bogf√∏rer vi forbrugsvarer brugt i produktionen?"
        },
        options: {
            loadingSpeakers: "‚è≥ Indl√¶ser talere...",
            generalQuestion: "Generelt Sp√∏rgsm√•l (Alle)",
            selectSpeaker: "V√¶lg taler..."
        },
        charCounter: "tegn", 
        submitButton: "üì§ Indsend Sp√∏rgsm√•l"
    },
    uk: {
        title: "–ü–∏—Ç–∞–Ω–Ω—è –¥–æ –î–æ–ø–æ–≤—ñ–¥–∞—á—ñ–≤",
        subtitle: "–ü–æ–¥–∞–π—Ç–µ —Å–≤–æ—î –ø–∏—Ç–∞–Ω–Ω—è",
        successMessage: "‚úÖ –í–∞—à–µ –ø–∏—Ç–∞–Ω–Ω—è –ø–æ–¥–∞–Ω–æ —É—Å–ø—ñ—à–Ω–æ! –í–æ–Ω–æ –±—É–¥–µ —Ä–æ–∑–≥–ª—è–Ω—É—Ç–æ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ç–æ—Ä–∞–º–∏.",
        labels: {
            name: "–Ü–º'—è *",
            company: "–ö–æ–º–ø–∞–Ω—ñ—è *",
            department: "–í—ñ–¥–¥—ñ–ª", 
            email: "E-Mail",
            targetSpeaker: "–ü–∏—Ç–∞–Ω–Ω—è –¥–æ *",
            subject: "–¢–µ–º–∞ *",
            question: "–¢–µ–∫—Å—Ç –ü–∏—Ç–∞–Ω–Ω—è *"
        },
        placeholders: {
            company: "–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É –∫–æ–º–ø–∞–Ω—ñ—ó...",
            department: "–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ –ë—É—Ö–≥–∞–ª—Ç–µ—Ä—ñ—è, –ü—Ä–æ–¥–∞–∂—ñ",
            email: "–Ø–∫—â–æ –≤–∞—à–µ –ø–∏—Ç–∞–Ω–Ω—è –Ω–µ –±—É–¥–µ –¥–∞–Ω–æ —É—Å–Ω–æ",
            subject: "–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ –í–∏—Ç—Ä–∞—Ç–∏ –Ω–∞ –ú–∞—Ç–µ—Ä—ñ–∞–ª–∏",
            questionText: "–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ –Ø–∫ –º–∏ –æ–±–ª—ñ–∫–æ–≤—É—î–º–æ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ —É –≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤—ñ?"
        },
        options: {
            loadingSpeakers: "‚è≥ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–æ–ø–æ–≤—ñ–¥–∞—á—ñ–≤...",
            generalQuestion: "–ó–∞–≥–∞–ª—å–Ω–µ –ü–∏—Ç–∞–Ω–Ω—è (–í—Å—ñ)",
            selectSpeaker: "–û–±–µ—Ä—ñ—Ç—å –¥–æ–ø–æ–≤—ñ–¥–∞—á–∞..."
        },
        charCounter: "—Å–∏–º–≤–æ–ª—ñ–≤", 
        submitButton: "üì§ –ü–æ–¥–∞—Ç–∏ –ü–∏—Ç–∞–Ω–Ω—è"
    },
    nl: {
        title: "Vragen aan Sprekers",
        subtitle: "Stel uw vraag",
        successMessage: "‚úÖ Uw vraag is succesvol ingediend! Het zal beoordeeld worden door de organisatoren.",
        labels: {
            name: "Naam *",
            company: "Bedrijf *",
            department: "Afdeling", 
            email: "E-Mail",
            targetSpeaker: "Vraag aan *",
            subject: "Onderwerp *",
            question: "Vraag Tekst *"
        },
        placeholders: {
            company: "Voer de bedrijfsnaam in...",
            department: "bijv. Boekhouding, Verkoop",
            email: "Als uw vraag niet mondeling wordt beantwoord",
            subject: "bijv. Verbruikskosten",
            questionText: "bijv. Hoe boeken we verbruiksgoederen die in productie worden gebruikt?"
        },
        options: {
            loadingSpeakers: "‚è≥ Sprekers laden...",
            generalQuestion: "Algemene Vraag (Alle)",
            selectSpeaker: "Selecteer spreker..."
        },
        charCounter: "tekens", 
        submitButton: "üì§ Vraag Indienen"
    },
    pt: {
        title: "Perguntas aos Oradores",
        subtitle: "Envie sua pergunta",
        successMessage: "‚úÖ Sua pergunta foi enviada com sucesso! Ser√° analisada pelos organizadores.",
        labels: {
            name: "Nome *",
            company: "Empresa *",
            department: "Departamento", 
            email: "E-Mail",
            targetSpeaker: "Pergunta para *",
            subject: "Assunto *",
            question: "Texto da Pergunta *"
        },
        placeholders: {
            company: "Digite o nome da empresa...",
            department: "ex. Contabilidade, Vendas",
            email: "Se sua pergunta n√£o for respondida verbalmente",
            subject: "ex. Despesas de Consum√≠veis",
            questionText: "ex. Como contabilizamos consum√≠veis usados na produ√ß√£o?"
        },
        options: {
            loadingSpeakers: "‚è≥ Carregando oradores...",
            generalQuestion: "Pergunta Geral (Todos)",
            selectSpeaker: "Selecionar orador..."
        },
        charCounter: "caracteres", 
        submitButton: "üì§ Enviar Pergunta"
    },
    ro: {
        title: "√éntrebƒÉri pentru Vorbitori",
        subtitle: "Trimite»õi √Æntrebarea dumneavoastrƒÉ",
        successMessage: "‚úÖ √éntrebarea dumneavoastrƒÉ a fost trimisƒÉ cu succes! Va fi examinatƒÉ de organizatori.",
        labels: {
            name: "Nume *",
            company: "Companie *",
            department: "Departament", 
            email: "E-Mail",
            targetSpeaker: "√éntrebare pentru *",
            subject: "Subiect *",
            question: "Textul √éntrebƒÉrii *"
        },
        placeholders: {
            company: "Introduce»õi numele companiei...",
            department: "ex. Contabilitate, V√¢nzƒÉri",
            email: "DacƒÉ √Æntrebarea nu este rƒÉspunsƒÉ verbal",
            subject: "ex. Cheltuieli cu Consumabile",
            questionText: "ex. Cum contabilizƒÉm consumabilele folosite √Æn produc»õie?"
        },
        options: {
            loadingSpeakers: "‚è≥ Se √ÆncarcƒÉ voritorii...",
            generalQuestion: "√éntrebare GeneralƒÉ (To»õi)",
            selectSpeaker: "Selecta»õi vorbitor..."
        },
        charCounter: "caractere", 
        submitButton: "üì§ Trimite √éntrebarea"
    },
    hr: {
        title: "Pitanja za Govornike",
        subtitle: "Po≈°aljite svoje pitanje",
        successMessage: "‚úÖ Va≈°e pitanje je uspje≈°no poslano! Bit ƒáe pregledano od strane organizatora.",
        labels: {
            name: "Ime *",
            company: "Tvrtka *",
            department: "Odjel", 
            email: "E-Mail",
            targetSpeaker: "Pitanje za *",
            subject: "Predmet *",
            question: "Tekst Pitanja *"
        },
        placeholders: {
            company: "Unesite naziv tvrtke...",
            department: "npr. Raƒçunovodstvo, Prodaja",
            email: "Ako va≈°e pitanje nije odgovoreno usmeno",
            subject: "npr. Tro≈°kovi Potro≈°nog Materijala",
            questionText: "npr. Kako knji≈æimo potro≈°ni materijal kori≈°ten u proizvodnji?"
        },
        options: {
            loadingSpeakers: "‚è≥ Uƒçitavaju se govornici...",
            generalQuestion: "Opƒáe Pitanje (Svi)",
            selectSpeaker: "Odaberite govornika..."
        },
        charCounter: "znakova", 
        submitButton: "üì§ Po≈°alji Pitanje"
    },
    pl: {
        title: "Pytania do Prelegent√≥w",
        subtitle: "Wy≈õlij swoje pytanie",
        successMessage: "‚úÖ Twoje pytanie zosta≈Ço pomy≈õlnie wys≈Çane! Zostanie przeanalizowane przez organizator√≥w.",
        labels: {
            name: "Imiƒô *",
            company: "Firma *",
            department: "Dzia≈Ç", 
            email: "E-Mail",
            targetSpeaker: "Pytanie do *",
            subject: "Temat *",
            question: "Tre≈õƒá Pytania *"
        },
        placeholders: {
            company: "Wprowad≈∫ nazwƒô firmy...",
            department: "np. Ksiƒôgowo≈õƒá, Sprzeda≈º",
            email: "Je≈õli pytanie nie bƒôdzie odpowiedziane ustnie",
            subject: "np. Wydatki na Materia≈Çy Eksploatacyjne",
            questionText: "np. Jak ksiƒôgujemy materia≈Çy eksploatacyjne u≈ºywane w produkcji?"
        },
        options: {
            loadingSpeakers: "‚è≥ ≈Åadowanie prelegent√≥w...",
            generalQuestion: "Pytanie Og√≥lne (Wszyscy)",
            selectSpeaker: "Wybierz prelegenta..."
        },
        charCounter: "znak√≥w", 
        submitButton: "üì§ Wy≈õlij Pytanie"
    },
    lv: {
        title: "JautƒÅjumi lektoriem",
        subtitle: "Nos≈´tƒ´t savu jautƒÅjumu",
        successMessage: "‚úÖ J≈´su jautƒÅjums ir veiksmƒ´gi nos≈´tƒ´ts! To izskatƒ´s organizatori.",
        labels: {
            name: "VƒÅrds *",
            company: "Uz≈Üƒìmums *",
            department: "Nodaƒºa", 
            email: "E-pasts",
            targetSpeaker: "JautƒÅjums priek≈° *",
            subject: "Tƒìma *",
            question: "JautƒÅjuma teksts *"
        },
        placeholders: {
            company: "Ievadiet uz≈Üƒìmuma nosaukumu...",
            department: "piemƒìram, GrƒÅmatvedƒ´ba, PƒÅrdo≈°ana",
            email: "Ja jautƒÅjums netiks atbildƒìts mutiski",
            subject: "piemƒìram, Patƒìri≈Üa materiƒÅlu izmaksas",
            questionText: "piemƒìram, KƒÅ mƒìs grƒÅmatojam ra≈æo≈°anƒÅ izlietotos patƒìri≈Üa materiƒÅlus?"
        },
        options: {
            loadingSpeakers: "‚è≥ IelƒÅdƒì lektorus...",
            generalQuestion: "VispƒÅrƒ´gs jautƒÅjums (Visi)",
            selectSpeaker: "Izvƒìlƒìties lektoru..."
        },
        charCounter: "rakstzƒ´mes", 
        submitButton: "üì§ Nos≈´tƒ´t jautƒÅjumu"
    },
    sl: {
        title: "Vpra≈°anja za Govorce",
        subtitle: "Po≈°ljite svoje vpra≈°anje",
        successMessage: "‚úÖ Va≈°e vpra≈°anje je bilo uspe≈°no poslano! Pregledali ga bodo organizatorji.",
        labels: {
            name: "Ime *",
            company: "Podjetje *",
            department: "Oddelek", 
            email: "E-po≈°ta",
            targetSpeaker: "Vpra≈°anje za *",
            subject: "Zadeva *",
            question: "Besedilo vpra≈°anja *"
        },
        placeholders: {
            company: "Vnesite ime podjetja...",
            department: "npr. Raƒçunovodstvo, Prodaja",
            email: "ƒåe na vpra≈°anje ne bo odgovorjeno ustno",
            subject: "npr. Stro≈°ki potro≈°nega materiala",
            questionText: "npr. Kako knji≈æimo potro≈°ni material, ki se uporablja v proizvodnji?"
        },
        options: {
            loadingSpeakers: "‚è≥ Nalaganje govorcev...",
            generalQuestion: "Splo≈°no vpra≈°anje (Vsi)",
            selectSpeaker: "Izberite govorca..."
        },
        charCounter: "znakov", 
        submitButton: "üì§ Po≈°lji vpra≈°anje"
    },
    et: {
        title: "K√ºsimused Esinejatele",
        subtitle: "Saada oma k√ºsimus",
        successMessage: "‚úÖ Teie k√ºsimus on edukalt saadetud! Korraldajad vaatavad selle √ºle.",
        labels: {
            name: "Nimi *",
            company: "Ettev√µte *",
            department: "Osakond", 
            email: "E-post",
            targetSpeaker: "K√ºsimus *",
            subject: "Teema *",
            question: "K√ºsimuse tekst *"
        },
        placeholders: {
            company: "Sisestage ettev√µtte nimi...",
            department: "nt. Raamatupidamine, M√º√ºk",
            email: "Kui k√ºsimusele ei vastata suuliselt",
            subject: "nt. Tarbematerjali kulud",
            questionText: "nt. Kuidas me arvestame tootmises kasutatud tarbematerjali?"
        },
        options: {
            loadingSpeakers: "‚è≥ Esinejate laadimine...",
            generalQuestion: "√úldine k√ºsimus (K√µik)",
            selectSpeaker: "Vali esineja..."
        },
        charCounter: "m√§rki", 
        submitButton: "üì§ Saada k√ºsimus"
    },
    fi: {
        title: "Kysymyksi√§ Puhujille",
        subtitle: "L√§het√§ kysymyksesi",
        successMessage: "‚úÖ Kysymyksesi on l√§hetetty onnistuneesti! J√§rjest√§j√§t tarkistavat sen.",
        labels: {
            name: "Nimi *",
            company: "Yritys *",
            department: "Osasto",
            email: "S√§hk√∂posti",
            targetSpeaker: "Kysymys *",
            subject: "Aihe *",
            question: "Kysymyksen teksti *"
        },
        placeholders: {
            company: "Sy√∂t√§ yrityksen nimi...",
            department: "esim. Kirjanpito, Myynti",
            email: "Jos kysymykseen ei vastata suullisesti",
            subject: "esim. Kulutustarvikkeiden kustannukset",
            questionText: "esim. Miten laskemme tuotannossa k√§ytetyt kulutustarvikkeet?"
        },
        options: {
            loadingSpeakers: "‚è≥ Ladataan puhujia...",
            generalQuestion: "Yleinen kysymys (Kaikki)",
            selectSpeaker: "Valitse puhuja..."
        },
        charCounter: "merkki√§",
        submitButton: "üì§ L√§het√§ kysymys"
    },
    sv: {
        title: "Fr√•gor till Talare",
        subtitle: "Skicka din fr√•ga",
        successMessage: "‚úÖ Din fr√•ga har skickats framg√•ngsrikt! Organisat√∂rerna kommer att granska den.",
        labels: {
            name: "Namn *",
            company: "F√∂retag *",
            department: "Avdelning",
            email: "E-post",
            targetSpeaker: "Fr√•ga *",
            subject: "√Ñmne *",
            question: "Fr√•getexten *"
        },
        placeholders: {
            company: "Ange f√∂retagsnamn...",
            department: "t.ex. Redovisning, F√∂rs√§ljning",
            email: "Om fr√•gan inte besvaras muntligt",
            subject: "t.ex. F√∂rbrukningskostnader",
            questionText: "t.ex. Hur r√§knar vi f√∂rbrukningsmaterial som anv√§nds i produktionen?"
        },
        options: {
            loadingSpeakers: "‚è≥ Laddar talare...",
            generalQuestion: "Allm√§n fr√•ga (Alla)",
            selectSpeaker: "V√§lj talare..."
        },
        charCounter: "tecken",
        submitButton: "üì§ Skicka fr√•ga"
    },
    cs: {
        title: "Ot√°zky pro ≈òeƒçn√≠ky",
        subtitle: "Po≈°lete svou ot√°zku",
        successMessage: "‚úÖ Va≈°e ot√°zka byla √∫spƒõ≈°nƒõ odesl√°na! Organiz√°to≈ôi ji zkontroluj√≠.",
        labels: {
            name: "Jm√©no *",
            company: "Spoleƒçnost *",
            department: "Oddƒõlen√≠",
            email: "E-mail",
            targetSpeaker: "Ot√°zka *",
            subject: "T√©ma *",
            question: "Text ot√°zky *"
        },
        placeholders: {
            company: "Zadejte n√°zev spoleƒçnosti...",
            department: "nap≈ô. √öƒçetnictv√≠, Prodej",
            email: "Pokud ot√°zka nebude zodpovƒõzena √∫stnƒõ",
            subject: "nap≈ô. N√°klady na spot≈ôebn√≠ materi√°l",
            questionText: "nap≈ô. Jak √∫ƒçtujeme spot≈ôebn√≠ materi√°l pou≈æ√≠van√Ω ve v√Ωrobƒõ?"
        },
        options: {
            loadingSpeakers: "‚è≥ Naƒç√≠t√°n√≠ ≈ôeƒçn√≠k≈Ø...",
            generalQuestion: "Obecn√° ot√°zka (V≈°ichni)",
            selectSpeaker: "Vyberte ≈ôeƒçn√≠ka..."
        },
        charCounter: "znak≈Ø",
        submitButton: "üì§ Odeslat ot√°zku"
    },
    hu: {
        title: "K√©rd√©sek az El≈ëad√≥khoz",
        subtitle: "K√ºldje el k√©rd√©s√©t",
        successMessage: "‚úÖ A k√©rd√©se sikeresen elk√ºldve! A szervez≈ëk √°tn√©zik.",
        labels: {
            name: "N√©v *",
            company: "V√°llalat *",
            department: "R√©szleg",
            email: "E-mail",
            targetSpeaker: "K√©rd√©s *",
            subject: "T√°rgy *",
            question: "K√©rd√©s sz√∂vege *"
        },
        placeholders: {
            company: "Adja meg a v√°llalat nev√©t...",
            department: "pl. K√∂nyvel√©s, √ârt√©kes√≠t√©s",
            email: "Ha a k√©rd√©sre nem v√°laszolnak sz√≥ban",
            subject: "pl. Fogy√≥eszk√∂z k√∂lts√©gek",
            questionText: "pl. Hogyan sz√°moljuk el a gy√°rt√°sban haszn√°lt fogy√≥eszk√∂z√∂ket?"
        },
        options: {
            loadingSpeakers: "‚è≥ El≈ëad√≥k bet√∂lt√©se...",
            generalQuestion: "√Åltal√°nos k√©rd√©s (Mindenki)",
            selectSpeaker: "V√°lasszon el≈ëad√≥t..."
        },
        charCounter: "karakter",
        submitButton: "üì§ K√©rd√©s k√ºld√©se"
    },
    lt: {
        title: "Klausimai Prane≈°ƒójams",
        subtitle: "Pateikite savo klausimƒÖ",
        successMessage: "‚úÖ J≈´s≈≥ klausimas sƒókmingai pateiktas! Organizatoriai jƒØ per≈æi≈´rƒós.",
        labels: {
            name: "Vardas *",
            company: "ƒÆmonƒó *",
            department: "Skyrius",
            email: "El. pa≈°tas",
            targetSpeaker: "Klausimas *",
            subject: "Tema *",
            question: "Klausimo tekstas *"
        },
        placeholders: {
            company: "ƒÆveskite ƒØmonƒós pavadinimƒÖ...",
            department: "pvz. Buhalterija, Pardavimai",
            email: "Jei ƒØ klausimƒÖ neatsakoma ≈æod≈æiu",
            subject: "pvz. Suvartojam≈≥j≈≥ med≈æiag≈≥ i≈°laidos",
            questionText: "pvz. Kaip apskaiƒçiuojame gamyboje naudojamas suvartojamƒÖsias med≈æiagas?"
        },
        options: {
            loadingSpeakers: "‚è≥ Kraunami prane≈°ƒójai...",
            generalQuestion: "Bendrasis klausimas (Visi)",
            selectSpeaker: "Pasirinkite prane≈°ƒójƒÖ..."
        },
        charCounter: "simboli≈≥",
        submitButton: "üì§ Pateikti klausimƒÖ"
    },
    sk: {
        title: "Ot√°zky pre Reƒçn√≠kov",
        subtitle: "Po≈°lite svoju ot√°zku",
        successMessage: "‚úÖ Va≈°a ot√°zka bola √∫spe≈°ne odoslan√°! Organiz√°tori ju skontroluj√∫.",
        labels: {
            name: "Meno *",
            company: "Spoloƒçnos≈• *",
            department: "Oddelenie",
            email: "E-mail",
            targetSpeaker: "Ot√°zka *",
            subject: "T√©ma *",
            question: "Text ot√°zky *"
        },
        placeholders: {
            company: "Zadajte n√°zov spoloƒçnosti...",
            department: "napr. √öƒçtovn√≠ctvo, Predaj",
            email: "Ak na ot√°zku nebude odpovedan√© √∫stne",
            subject: "napr. N√°klady na spotrebn√Ω materi√°l",
            questionText: "napr. Ako √∫ƒçtujeme spotrebn√Ω materi√°l pou≈æ√≠van√Ω vo v√Ωrobe?"
        },
        options: {
            loadingSpeakers: "‚è≥ Naƒç√≠tavanie reƒçn√≠kov...",
            generalQuestion: "V≈°eobecn√° ot√°zka (V≈°etci)",
            selectSpeaker: "Vyberte reƒçn√≠ka..."
        },
        charCounter: "znakov",
        submitButton: "üì§ Odosla≈• ot√°zku"
    },
    bg: {
        title: "–í—ä–ø—Ä–æ—Å–∏ –∫—ä–º –õ–µ–∫—Ç–æ—Ä–∏—Ç–µ",
        subtitle: "–ò–∑–ø—Ä–∞—Ç–µ—Ç–µ —Å–≤–æ—è –≤—ä–ø—Ä–æ—Å",
        successMessage: "‚úÖ –í–∞—à–∏—è—Ç –≤—ä–ø—Ä–æ—Å –±–µ—à–µ –∏–∑–ø—Ä–∞—Ç–µ–Ω —É—Å–ø–µ—à–Ω–æ! –û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∏—Ç–µ —â–µ –≥–æ –ø—Ä–µ–≥–ª–µ–¥–∞—Ç.",
        labels: {
            name: "–ò–º–µ *",
            company: "–ö–æ–º–ø–∞–Ω–∏—è *",
            department: "–û—Ç–¥–µ–ª",
            email: "–ò-–º–µ–π–ª",
            targetSpeaker: "–í—ä–ø—Ä–æ—Å *",
            subject: "–¢–µ–º–∞ *",
            question: "–¢–µ–∫—Å—Ç –Ω–∞ –≤—ä–ø—Ä–æ—Å–∞ *"
        },
        placeholders: {
            company: "–í—ä–≤–µ–¥–µ—Ç–µ –∏–º–µ—Ç–æ –Ω–∞ –∫–æ–º–ø–∞–Ω–∏—è—Ç–∞...",
            department: "–Ω–∞–ø—Ä. –°—á–µ—Ç–æ–≤–æ–¥—Å—Ç–≤–æ, –ü—Ä–æ–¥–∞–∂–±–∏",
            email: "–ê–∫–æ –≤—ä–ø—Ä–æ—Å—ä—Ç –Ω–µ –±—ä–¥–µ –æ—Ç–≥–æ–≤–æ—Ä–µ–Ω —É—Å—Ç–Ω–æ",
            subject: "–Ω–∞–ø—Ä. –†–∞–∑—Ö–æ–¥–∏ –∑–∞ –∫–æ–Ω—Å—É–º–∞—Ç–∏–≤–∏",
            questionText: "–Ω–∞–ø—Ä. –ö–∞–∫ –æ—Ç—á–∏—Ç–∞–º–µ –∫–æ–Ω—Å—É–º–∞—Ç–∏–≤–∏—Ç–µ, –∏–∑–ø–æ–ª–∑–≤–∞–Ω–∏ –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ—Ç–æ?"
        },
        options: {
            loadingSpeakers: "‚è≥ –ó–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ –ª–µ–∫—Ç–æ—Ä–∏...",
            generalQuestion: "–û–±—â –≤—ä–ø—Ä–æ—Å (–í—Å–∏—á–∫–∏)",
            selectSpeaker: "–ò–∑–±–µ—Ä–µ—Ç–µ –ª–µ–∫—Ç–æ—Ä..."
        },
        charCounter: "–∑–Ω–∞—Ü–∏",
        submitButton: "üì§ –ò–∑–ø—Ä–∞—â–∞–Ω–µ –Ω–∞ –≤—ä–ø—Ä–æ—Å"
    },
    mt: {
        title: "Mistoqsijiet gƒßall-Kelliem",
        subtitle: "Ibgƒßat il-mistoqsija tiegƒßek",
        successMessage: "‚úÖ Il-mistoqsija tiegƒßek intbagƒßtet b'suƒãƒãess! L-organizzaturi se jirreveduha.",
        labels: {
            name: "Isem *",
            company: "Kumpanija *",
            department: "Dipartiment",
            email: "E-mail",
            targetSpeaker: "Mistoqsija *",
            subject: "Suƒ°ƒ°ett *",
            question: "Test tal-mistoqsija *"
        },
        placeholders: {
            company: "Daƒßƒßal l-isem tal-kumpanija...",
            department: "e≈º. Kontabilit√†, Bejgƒß",
            email: "Jekyll il-mistoqsija ma titwieƒ°bx bi kliem",
            subject: "e≈º. Spejje≈º tal-konsumabbli",
            questionText: "e≈º. Kif nikkalkula l-konsumabbli u≈ºati fil-produzzjoni?"
        },
        options: {
            loadingSpeakers: "‚è≥ Qed jitgƒßabbew il-kelliem...",
            generalQuestion: "Mistoqsija ƒ°enerali (Kulƒßadd)",
            selectSpeaker: "Agƒß≈ºel kelliem..."
        },
        charCounter: "karattri",
        submitButton: "üì§ Ibgƒßat mistoqsija"
    }
};

// Initialize i18next for Questions Form
async function initFormTranslations() {
    try {
        loadFormLanguage();
        
        await i18next.init({
            lng: currentFormLanguage,
            fallbackLng: 'el',
            resources: {
                el: { translation: formTranslations.el },
                en: { translation: formTranslations.en },
                fr: { translation: formTranslations.fr },
                de: { translation: formTranslations.de },
                es: { translation: formTranslations.es },
                it: { translation: formTranslations.it },
                da: { translation: formTranslations.da },
                uk: { translation: formTranslations.uk },
                nl: { translation: formTranslations.nl },
                pt: { translation: formTranslations.pt },
                ro: { translation: formTranslations.ro },
                hr: { translation: formTranslations.hr },
                pl: { translation: formTranslations.pl },
                lv: { translation: formTranslations.lv },
                sl: { translation: formTranslations.sl },
                et: { translation: formTranslations.et },
                fi: { translation: formTranslations.fi },
                sv: { translation: formTranslations.sv },
                cs: { translation: formTranslations.cs },
                hu: { translation: formTranslations.hu },
                lt: { translation: formTranslations.lt },
                sk: { translation: formTranslations.sk },
                bg: { translation: formTranslations.bg },
                mt: { translation: formTranslations.mt }
            },
            interpolation: {
                escapeValue: false
            }
        });

        console.log('‚úÖ Q-Form i18next initialized - Language:', i18next.language);
        updateFormInterface();
        updateLanguageSelector();
        
    } catch (error) {
        console.error('‚ùå Q-Form i18next initialization failed:', error);
    }
}

// Update form interface language
function updateFormInterface() {
    console.log('üîÑ Updating Q-Form interface language to:', i18next.language);
    
    // Update document title
    document.title = i18next.t('title');
    
    // Update elements with data-i18n attributes
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        const translation = i18next.t(key);
        
        // Debug logging
        if (translation === key) {
            console.warn(`Q-Form translation missing for key: ${key}`);
        }
        
        element.textContent = translation;
    });
    
    // Update elements with data-i18n-placeholder attributes
    document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
        const key = element.getAttribute('data-i18n-placeholder');
        const translation = i18next.t(key);
        
        // Debug logging
        if (translation === key) {
            console.warn(`Q-Form placeholder translation missing for key: ${key}`);
        }
        
        element.placeholder = translation;
    });
}

// Update language selector visual state
function updateLanguageSelector() {
    document.querySelectorAll('.lang-flag').forEach(flag => {
        const lang = flag.getAttribute('data-lang');
        if (lang === i18next.language) {
            flag.style.opacity = '1';
            flag.style.transform = 'scale(1.1)';
        } else {
            flag.style.opacity = '0.7';
            flag.style.transform = 'scale(1)';
        }
    });
}

// Switch language function
function switchLanguage(lang) {
    console.log('üåê Q-Form Language changing to:', lang);
    currentFormLanguage = lang;
    saveFormLanguage(lang);
    
    i18next.changeLanguage(lang).then(() => {
        updateFormInterface();
        updateLanguageSelector();
        // Reload speakers dropdown to update language
        loadSpeakers();
        console.log(`‚úÖ Q-Form language changed to: ${lang}`);
    }).catch(error => {
        console.error('‚ùå Error changing Q-Form language:', error);
    });
}

// Initialize on DOM load
document.addEventListener('DOMContentLoaded', function() {
    initFormTranslations();
});

// Add hover effects to language flags
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.lang-flag').forEach(flag => {
        flag.addEventListener('mouseenter', function() {
            if (this.getAttribute('data-lang') !== i18next.language) {
                this.style.opacity = '1';
            }
        });
        
        flag.addEventListener('mouseleave', function() {
            if (this.getAttribute('data-lang') !== i18next.language) {
                this.style.opacity = '0.7';
            }
        });
    });
});
</script>
    
</body>
</html>